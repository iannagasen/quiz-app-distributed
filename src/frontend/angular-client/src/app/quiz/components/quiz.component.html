<div class='flex min-h-screen items-stretch'>
  <div class='basis-1/4 m-2'>
    navBar
  </div>
  <div class='basis-1/2 m-2'>
    <div class="flex flex-col p-2 m-2">
      <!--HEADER-->
      <div class="flex justify-between mb-4">
        <div class='flex-grow text-4xl font-extrabold orange_gradient'>
          Topic
        </div>
        <div class='flex-shrink text-2xl font-extrabold'>
          {{topic}}
        </div>
      </div>
      <!--HEADER-->

      <!--QUESTION MANAGER-->
      <form [formGroup]="quizForm" (ngSubmit)="onClickFormButton()">
        <div formArrayName="questions" class="no-scrollbar overflow-y-auto max-h-[80vh]">
          <div *ngFor="let questionGroup of getQuestionControls(); let i = index">
            <div [formGroupName]="i"
              [ngClass]="[
                'bg-clr-secondary rounded-md text-white m-3 p-3 mb-4',
                isSubmitted && !willShowResult && questionGroup.get('selectedChoiceId')?.value !== -1 ?
                questionGroup.get('selectedChoiceId')?.value === questionGroup.get('correctChoiceId')?.value
                  ? 'border-2 border-green-500'
                  : 'border-2 border-red-500'
                  : ''
              ]">
              <textarea 
                formControlName="question"
                [rows]="getRows(questionGroup.value.question)"
                class="block w-full resize-none align-bottom outline-none border-0 border-b-2 bg-inherit text-lg font-semibold focus:border-blue-400 focus:ring-0"
              ></textarea>
              <!--MULTIPLE CHOICES-->
              <div formArrayName="choices" class="pt-2 mx-auto space-y-2">
                <ng-container *ngFor="let choiceGroup of getChoiceControlsFromQuestion(questionGroup); let j = index">
                  <div [formGroupName]="j" class="flex space-x-2">
                    <div class="flex h-5 items-center">
                      <input
                        formControlName="initial"
                        type="radio"
                        class="h-4 w-4 mt-1.5 rounded-full text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 focus:ring-offset-0 disabled:cursor-not-allowed"
                        [attr.name]="'question_'+i"
                        [value]="choiceGroup.get('id')?.value"
                        [attr.disabled]="isSubmitted ? true : null"
                        [checked]="questionGroup.get('selectedChoiceId')?.value === choiceGroup.get('id')?.value"
                        (change)="questionGroup.patchValue({ selectedChoiceId: choiceGroup.get('id')?.value })"
                      >
                    </div>
                    <label class="text-sm">
                      <div class="font-medium text-base">{{choiceGroup.get('value')?.value}}</div>
                      <p>{{choiceGroup.get('explanation')?.value}}</p>
                    </label>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
        </div>
        <button class="bg-clr-accent w-full rounded-md py-3 mx-2 mt-5" [ngClass]="!isSubmitted ? 'bg-clr-accent' : 'bg-clr-modal'">
          {{!isSubmitted ? 'Submit' : 'Retake'}}
        </button>
      </form>
      <!--END: QUESTION MANAGER-->
      <div
        *ngIf="willShowResult"
        class="fixed inset-0 z-[999] grid h-screen w-screen place-items-center backdrop-blur-sm transition-opacity duration-300"
      >
        <div class="rounded-md bg-clr-modal opacity-85 my-auto">
          <div class='text-3xl font-extrabold mb-2'>Quiz Statistics</div>
            <div class='text-xl'>Score: {{scoreSummary.score}}</div>
            <div class='text-xl'>Unanswered {{scoreSummary.unanswered}}</div>
            <div class='text-xl'>Total: {{scoreSummary.total}}</div>
            <button (click)="willShowResult = false" class="bg-clr-accent rounded-md w-full">
              OK
            </button>
        </div>
      </div>  


    </div>
  </div>
  <div class='basis-1/4 m-2'>
    statBar
  </div>
</div>

                      